# ImageNet

## Performance

Test on [ILSVR2012_img_val.tar]() （you can reference [Prepare the ImageNet dataset](https://gluon-cv.mxnet.io/build/examples_datasets/imagenet.html#sphx-glr-build-examples-datasets-imagenet-py) to download this dataset）

Note：

- v1 means using `PIL.Image`
- v2 means using `opencv-python`

### ResNet

| Model           | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| --------------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| ResNet18_v1     | 70.93            | 89.92            | 69.53      | 89.11      | 70.18      | 89.52      |
| ResNet34_v1     | 74.37            | 91.87            | 73.20      | 91.40      | 74.04      | 91.82      |
| ResNet50_v1     | 77.36            | 93.57            | 76.31      | 93.00      | 77.16      | 93.56      |
| ResNet101_v1    | 78.34            | 94.01            | 77.49      | 93.58      | 78.23      | 94.09      |
| ResNet152_v1    | 79.22            | 94.64            | 78.42      | 94.21      |            |            |
| ResNet18_v1b    | 70.94            | 89.83            | 69.57      | 89.11      | 70.08      | 89.44      |
| ResNet34_v1b    | 74.65            | 92.08            | 73.52      | 91.49      | 74.11      | 92.16      |
| ResNet50_v1b    | 77.67            | 93.82            | 76.87      | 93.20      | 77.57      | 93.58      |
| ResNet50_v1b_gn | 77.36            | 93.59            | 76.62      | 93.05      | 77.22      | 93.54      |
| ResNet101_v1b   | 79.20            | 94.61            | 78.49      | 94.14      | 79.12      | 94.47      |
| ResNet152_v1b   | 79.69            | 94.74            | 78.87      | 94.41      |            |            |
| ResNet50_v1c    | 78.03            | 94.09            | 77.18      | 93.72      | 77.89      | 94.02      |
| ResNet101_v1c   | 79.60            | 94.75            | 78.84      | 94.20      | 79.48      | 94.72      |
| ResNet152_v1c   | 80.01            | 94.96            | 79.53      | 94.57      |            |            |
| ResNet50_v1d    | 79.15            | 94.58            | 78.55      | 94.17      | 79.04      | 94.61      |
| ResNet101_v1d   | 80.51            | 95.12            | 79.79      | 94.88      | 80.52      | 95.23      |
| ResNet152_v1d   | 80.61            | 95.34            | 80.20      | 95.00      |            |            |
| ResNet18_v2     | 71.00            | 89.92            | 69.49      | 89.09      | 70.10      | 89.48      |
| ResNet34_v2     | 74.40            | 92.08            | 73.51      | 91.42      | 74.37      | 92.02      |
| ResNet50_v2     | 77.11            | 93.43            | 76.27      | 92.89      | 77.00      | 93.36      |
| ResNet101_v2    | 78.53            | 94.17            | 77.89      | 93.76      | 78.52      | 94.15      |
| ResNet152_v2    | 79.21            | 94.31            | 78.45      | 94.07      |            |            |

### ReNext

| Model               | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| ------------------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| ResNext50_32x4d     | 79.32            | 94.53            | 78.79      | 94.15      | 79.41      | 94.54      |
| ResNext101_32x4d    | 80.37            | 95.06            | 79.74      | 94.61      | 80.52      | 95.20      |
| ResNext101_64x4d    | 80.69            | 95.17            | 80.03      | 94.71      | 80.84      | 95.27      |
| SE_ResNext50_32x4d  | 79.95            | 94.93            | 79.56      | 94.68      | 80.17      | 94.97      |
| SE_ResNext101_32x4d | 80.91            | 95.39            | 80.67      | 95.01      | 81.27      | 95.42      |
| SE_ResNext101_64x4d | 81.01            | 95.32            | 80.60      | 95.14      | 81.19      | 95.60      |

### MobileNet

| Model            | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| ---------------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| MobileNet1.0     | 73.28            | 91.30            | 72.31      | 90.64      | 72.85      | 91.12      |
| MobileNet0.75    | 70.25            | 89.49            | 69.00      | 88.76      | 69.85      | 89.46      |
| MobileNet0.5     | 65.20            | 86.34            | 63.52      | 85.12      | 64.19      | 85.71      |
| MobileNet0.25    | 52.91            | 76.94            | 50.81      | 75.03      | 51.09      | 75.36      |
| MobileNetV2_1.0  | 71.92            | 90.56            | 70.14      | 89.38      | 71.78      | 90.36      |
| MobileNetV2_0.75 | 69.61            | 88.95            | 67.84      | 87.84      |            |            |
| MobileNetV2_0.5  | 64.49            | 85.47            | 62.76      | 84.15      |            |            |
| MobileNetV2_0.25 | 50.74            | 74.56            | 49.35      | 73.28      |            |            |

### VGG

| Model    | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| -------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| VGG11    | 66.62            | 87.34            | 50.93      | 75.21      |            |            |
| VGG13    | 67.74            | 88.11            | 51.40      | 75.51      |            |            |
| VGG16    | 73.23            | 91.31            | 59.43      | 82.24      |            |            |
| VGG19    | 74.11            | 91.35            | 62.56      | 84.23      |            |            |
| VGG11_bn | 68.59            | 88.72            | 61.88      | 84.10      |            |            |
| VGG13_bn | 68.84            | 88.82            | 63.54      | 85.57      |            |            |
| VGG16_bn | 73.10            | 91.76            | 62.51      | 84.64      |            |            |
| VGG19_bn | 74.33            | 91.85            | 65.10      | 86.51      |            |            |

### SqueezeNet

| Model         | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| ------------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| SqueezeNet1.0 | 56.11            | 79.09            | 56.84      | 79.31      |            |            |
| SqueezeNet1.1 | 54.96            | 78.17            | 57.01      | 79.54      |            |            |

### DenseNet

| Model       | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| ----------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| DenseNet121 | 74.97            | 92.25            | 73.67      | 91.55      |            |            |
| DenseNet161 | 77.70            | 93.80            | 76.71      | 93.32      |            |            |
| DenseNet169 | 76.17            | 93.17            | 75.19      | 92.46      |            |            |
| DenseNet201 | 77.32            | 93.62            | 76.15      | 92.98      |            |            |

### Pruned ResNet

| Model              | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| ------------------ | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| resnet18_v1b_0.89  | 67.2             | 87.45            | 65.71      | 86.68      |            |            |
| resnet50_v1d_0.86  | 78.02            | 93.82            | 76.84      | 93.41      |            |            |
| resnet50_v1d_0.48  | 74.66            | 92.34            | 73.72      | 91.64      |            |            |
| resnet50_v1d_0.37  | 70.71            | 89.74            | 69.33      | 88.82      |            |            |
| resnet50_v1d_0.11  | 63.22            | 84.79            | 61.26      | 83.31      |            |            |
| resnet101_v1d_0.76 | 79.46            | 94.69            | 78.96      | 94.29      |            |            |
| resnet101_v1d_0.73 | 78.89            | 94.48            | 78.10      | 93.97      | 78.68      | 94.41      |

### Others

| Model       | Top-1 (gluon-cv) | Top-5 (gluon-cv) | Top-1 (v1) | Top-5 (v1) | Top-1 (v2) | Top-5 (v2) |
| ----------- | ---------------- | ---------------- | ---------- | ---------- | ---------- | ---------- |
| AlexNet     | 54.92            | 78.03            | 54.85      | 78.04      |            |            |
| darknet53   | 78.56            | 94.43            | 78.05      | 94.12      |            |            |
| InceptionV3 | 78.77            | 94.39            | 72.56      | 90.76      |            |            |
| SENet_154   | 81.26            | 95.51            | 81.00      | 95.38      |            |            |

## Demo

Recognize objects in an given image. (Please download pre-trained model to `~/.torch/models` first. --- If you put pre-trained model to other folder, please change the `--root`)

```shell
$ python demo_imagenet_cv.py [--model ResNet18_v1] [--cuda] [--input-pic <image>.jpg]
```

## Evaluation

The default data root is `~/.torch/datasets`  (You can download dataset and build a soft-link to it)

```shell
$ python eval_imagenet_cv.py [--model ResNet18_v1] [--batch-size 64] [-j 8] [--cuda]
```

